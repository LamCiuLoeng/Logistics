{% extends "master.html" %}

{% block extJS %}

{% endblock %}

{% block content %}
	<ul>
		<li><a href="{{url_for('.view', action = 'revise')}}">{{_('Update')}}</a></li>
		<li><a href="{{url_for('.view', action = 'cancel')}}">{{_('Cancel')}}</a></li>
		<li><a href="{{url_for('.view')}}">{{_('Return')}}</a></li>
	</ul>	
	
	<table border="1" cellpadding="3" cellspacing="3">
		<tr>
			<td>{{_('3rd Party Supplier')}}</td>
			<td>{{header.supplier}}</td>
		</tr>
		<tr>
			<td>{{_('Deliver Number')}}</td>
			<td>{{header.no}}</td>
		</tr>
		<tr>
			<td>{{_('Destination')}}</td>
			<td>{{header.destination_address|ifFalse}}</td>
		</tr>
		<tr>
			<td>{{_('Supplier Contact')}}</td>
			<td>{{header.supplier_contact|ifFalse}}</td>
		</tr>
		<tr>
			<td>{{_('Supplier Tel')}}</td>
			<td>{{header.supplier_tel|ifFalse}}</td>
		</tr>
		<tr>
			<td>{{_('Expect Time')}}</td>
			<td>{{header.expect_time|ifFalse}}</td>
		</tr>
		<tr>
			<td>{{_('Remark')}}</td>
			<td>{{header.remark|ifFalse}}</td>
		</tr>
		<tr>
			<td>{{_('Create Time')}}</td>
			<td>{{header.create_time|ft}}</td>
		</tr>
		<tr>
			<td>{{_('Creator')}}</td>
			<td>{{header.create_by|ifFalse}}</td>
		</tr>
		<tr>
			<td>{{_('Update Time')}}</td>
			<td>{{header.update_time|ft}}</td>
		</tr>
		<tr>
			<td>{{_('Last Updator')}}</td>
			<td>{{header.update_by|ifFalse}}</td>
		</tr>
		<tr>
			<td>{{_('Status')}}</td>
			<td>{{header.status|showStatus}}</td>
		</tr>
	</table>
	<br />
	<table border="1" cellpadding="3" cellspacing="3">
		<thead>
			<tr>
				<td>{{_('Customer')}}</td>
				<td>{{_('Order Number')}}</td>
				<td>{{_('Destination')}}</td>
				<td>{{_('Item')}}</td>
				<td>{{_('Qty')}}</td>
				<td>{{_('Weight')}}</td>
				<td>{{_('Expect Time')}}</td>
				<td>{{_('Destination Contact')}}</td>
				<td>{{_('Destination Tel')}}</td>
				<td>{{_('Remark')}}</td>
				<td>{{_('Create Time')}}</td>
				<td>{{_('Creator')}}</td>
				<td>{{_('Update Time')}}</td>
				<td>{{_('Last Updator')}}</td>
			</tr>
		</thead>
		{% for d in header.details %}
			<tr>
				<td>{{d.order_detail.header.customer}}</td>
				<td>{{d.order_detail.header.no}}</td>
				<td>{{d.order_detail.destination_address}}</td>
				<td>{{d.order_detail.item}}</td>
				<td>{{d.order_detail.order_qty}}&nbsp;{{d.order_detail.unit}}</td>
				<td>{{d.order_detail.weight}}&nbsp;{{d.order_detail.weight_unit}}</td>
				<td>{{d.order_detail.expect_time|ifFalse}}</td>
				<td>{{d.order_detail.destination_contact}}</td>
				<td>{{d.order_detail.destination_tel}}</td>
				<td>{{d.order_detail.remark|ifFalse}}</td>
				<td>{{d.order_detail.create_time|ft}}</td>
				<td>{{d.order_detail.create_by|ifFalse}}</td>
				<td>{{d.order_detail.update_time|ft}}</td>
				<td>{{d.order_detail.update_by|ifFalse}}</td>
			</tr>
		{% endfor %}
	</table>
	
	<br />
	
	{% if header.status in [SORTING[0],]%}
		<p>确认发货</p>
		<form action="{{url_for('.view', action = 'do_action',id=values.get('id',''),sc='SEND_OUT')}}" method="post">
			<table>
				<tr>
					<td>{{_('Remark')}}</td>
					<td><textarea name="send_out_remark"></textarea></td>
				</tr>
				<tr>
					<td colspan="2"><input type="submit" value="{{_('Submit')}}"/></td>
				</tr>
			</table>
		</form>
	{% endif %}
	
	{% if header.status in [SEND_OUT[0],]%}
		<p>确认货物到达</p>
		<form action="{{url_for('.view', action = 'do_action',id=values.get('id',''),sc='GOODS_ARRIVED')}}" method="post">
			<table>
				<tr>
					<td>{{_('Arrival Time')}}</td>
					<td><input type="text" name="actual_time" /></td>
				</tr>
				<tr>
					<td>{{_('Remark')}}</td>
					<td><textarea name="arrived_remark"></textarea></td>
				</tr>
				<tr>
					<td colspan="2"><input type="submit" value="{{_('Submit')}}"/></td>
				</tr>
			</table>
		</form>
	{% endif %}
	
{% endblock %}